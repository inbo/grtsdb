<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Usage of grtsdb • grtsdb</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Basic Usage of grtsdb">
<meta property="og:description" content="grtsdb">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">grtsdb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../news/index.html">NEWS</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic.html">Basic Usage of grtsdb</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../CONTRIBUTING.html">Contributing</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/inbo/grtsdb" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/INBOVlaanderen" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://www.facebook.com/pg/INBOVlaanderen" class="external-link">
    <span class="fa fa-facebook"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic Usage of grtsdb</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/inbo/grtsdb/blob/HEAD/vignettes/basic.Rmd" class="external-link"><code>vignettes/basic.Rmd</code></a></small>
      <div class="hidden name"><code>basic.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="short-introduction-to-generalized-random-tessellation-stratified-sampling-grts">Short introduction to Generalized Random Tessellation Stratified sampling (GRTS)<a class="anchor" aria-label="anchor" href="#short-introduction-to-generalized-random-tessellation-stratified-sampling-grts"></a>
</h2>
<div class="section level3">
<h3 id="quadrant-recursive-map">Quadrant recursive map<a class="anchor" aria-label="anchor" href="#quadrant-recursive-map"></a>
</h3>
<p>A key component of GRTS is translating 2D coordinates to 1D coordinates. This is done by quadrant recursive maps <span class="citation">(Stevens and Olsen 1999, 2004)</span>. The map is split in 4 quadrants by splitting it halfway along the north-south axis and halfway along the east-west axis. This yields the level-1 split. Each quadrant of level-1 is in a similar way split into 4 sub quadrants. This yields 16 level-2 quadrants. This is recursively applied until each quadrant contains only one element or the dimensions of the quadrants are small enough. We give an example with three levels in the figure below.</p>
<div class="figure">
<img src="basic_files/figure-html/quandrant-recursive-1.png" alt="Example of a quandrant recursive map with three levels." width="700"><p class="caption">
Example of a quandrant recursive map with three levels.
</p>
</div>
</div>
<div class="section level3">
<h3 id="reverse-hierarchical-ordering">Reverse hierarchical ordering<a class="anchor" aria-label="anchor" href="#reverse-hierarchical-ordering"></a>
</h3>
<p>We index each sub quadrant within a quadrant uniquely with the numbers 0, 1, 2 or 3 (figure above). The combination of this index with the indices of all lower levels gives a unique 1D address to each sub quadrant. The level-1 quadrants need only 1 index, the level-2 quadrants require 2 indices (level-1 and level-2), …</p>
<p>The 1D address can be though of as a base-4 number. In a typical hierarchical order we would use level-1 as the highest digit, level-2 as the next digit, and so on. The figure below shows the base-4 indices up to the third level. The background of each cell is coloured along a gradient of address (after conversion to base-10). The change in colour clearly reflects the level-1 structure. Adding 1 to the lowest digit (level-3 in this example), results in 3 out of 4 times in moving to a neighbouring cell. In other cases we would go to a cell in a neighbouring quadrant of a higher level. Thus the 1D address of neighbouring cells will be similar.</p>
<div class="figure">
<img src="basic_files/figure-html/quandrant-recursive-base10-1.png" alt="Example of a quandrant recursive map with three levels and base-4 indices." width="700"><p class="caption">
Example of a quandrant recursive map with three levels and base-4 indices.
</p>
</div>
<p>The picture changes if we reverse the hierarchical order (fig below). Now we use level-1 as the lowest digit, level-2 as the second lowest digit, and so on.</p>
<p>Adding 1 to the lowest digit, will now result in moving to another level-1 quadrant. Hence the corresponding movement in 2D is always large.</p>
<div class="figure">
<img src="basic_files/figure-html/quandrant-recursive-base10rev-1.png" alt="Example of a quandrant recursive map with three levels and reverse hierarchical base-4 indices." width="700"><p class="caption">
Example of a quandrant recursive map with three levels and reverse hierarchical base-4 indices.
</p>
</div>
</div>
<div class="section level3">
<h3 id="randomisation">Randomisation<a class="anchor" aria-label="anchor" href="#randomisation"></a>
</h3>
<p>The randomisation is done by permuting the indices of sub quadrant. Each split of a quadrant in 4 sub quadrants uses an independent random permutation.</p>
</div>
<div class="section level3">
<h3 id="selection-of-the-sample">Selection of the sample<a class="anchor" aria-label="anchor" href="#selection-of-the-sample"></a>
</h3>
<p>The actual selection of the sample from the 1D address come in two flavours. The oldest flavour <span class="citation">(Stevens and Olsen 1999)</span> uses the normal hierarchical ordering. The actual sample uses a systematic sampling along the 1D addresses. It samples every <span class="math inline">\(N/n\)</span> 1D address and uses a random start between <span class="math inline">\(0\)</span> and <span class="math inline">\(N/n - 1\)</span>.</p>
<p>A more recent flavour <span class="citation">Theobald et al. (2007)</span>, is based on the reverse hierarchical ordering. The actual sample uses the first <span class="math inline">\(n\)</span> 1D addresses.</p>
<div class="section level4">
<h4 id="benefits-of-the-normal-hierarchical-order">Benefits of the normal hierarchical order<a class="anchor" aria-label="anchor" href="#benefits-of-the-normal-hierarchical-order"></a>
</h4>
<ul>
<li>Unequal probability sampling is easy to implement. Consider each 1D address to be a line segment with length proportional to inclusion probability. Concatenate all line segments according to the order of the 1D address. Take a systematic sample along this concatenated line.</li>
</ul>
</div>
<div class="section level4">
<h4 id="benefits-of-the-revese-hierarchical-order">Benefits of the revese hierarchical order<a class="anchor" aria-label="anchor" href="#benefits-of-the-revese-hierarchical-order"></a>
</h4>
<ul>
<li>Replacement of drop-out samples is easy. Just take the next available 1D address.</li>
<li>Repeated sampling in time is possible, provided the entire region is covered as a GRTS grid.</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="main-functionality-of-grtsdb">Main functionality of grtsdb<a class="anchor" aria-label="anchor" href="#main-functionality-of-grtsdb"></a>
</h2>
<p>The most import functions of <code>grtsdb</code> are <code><a href="../reference/connect_db.html">connect_db()</a></code>, <code><a href="../reference/add_level.html">add_level()</a></code> and <code><a href="../reference/extract_sample.html">extract_sample()</a></code>. As <code>grtsdb</code> stores the randomised grid in a SQLite database, you first need to connect to such database with <code><a href="../reference/connect_db.html">connect_db()</a></code>. The default uses a file called <code>grtsdb.sqlite</code> in the current working directory. The function creates the file when it doesn’t exist. <code>":memory:"</code> is a special type of “file”: the database is stored in memory and not on disk. Such database will be lost when the user disconnects. Databases stores on disk can be reused later.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://inbo.github.io/grtsdb/" class="external-link">grtsdb</a></span><span class="op">)</span>
<span class="va">db_mem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect_db.html">connect_db</a></span><span class="op">(</span><span class="st">":memory:"</span><span class="op">)</span></code></pre></div>
<p>The second step is the generate the randomised grids in the database using <code><a href="../reference/add_level.html">add_level()</a></code>. This requires at least a connection to the database, the bounding box (<span class="math inline">\((x_0, x_1, y_0, y_1)\)</span>) and the cell size of the grid (<span class="math inline">\(s\)</span>). The function determines the largest grid required to cover the bounding box with a grid of the required cell size. Each dimension of this grid gets the same number of cells and this number will be a power of 2. We take the maximum of the number of grid cells in each dimension. The ceiling of a the <span class="math inline">\(\log\)</span> base 2 of this maximum is the required level <span class="math inline">\(n\)</span> because <span class="math inline">\(2^n\)</span> will be larger or equal to this maximum.</p>
<p><span class="math display">\[n = \lceil\log_2\frac{\max(x_1 - x_0, y_1 - y_0)}{s}\rceil\]</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">50000</span><span class="op">)</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25000</span>, <span class="fl">10000</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">cellsize</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="fu"><a href="../reference/add_level.html">add_level</a></span><span class="op">(</span>bbox <span class="op">=</span> <span class="va">bbox</span>, cellsize <span class="op">=</span> <span class="va">cellsize</span>, grtsdb <span class="op">=</span> <span class="va">db_mem</span><span class="op">)</span>
<span class="co">#&gt; Required number of levels: 6</span>
<span class="co">#&gt; Adding level 1: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 2: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 3: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 4: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 5: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 6: create table, add coordinates, calculate ranking</span></code></pre></div>
<p>Now we are ready to take a sample using <code><a href="../reference/extract_sample.html">extract_sample()</a></code> on the database. The result is a data frame containing the coordinates (centroids of the grid cell) and their ranking. The <code>samplesize</code> arguments defines to number of grid cells to return. The grid is on-the-fly defined by the bounding box and the cell size. The function returns the grid cells within the bounding box and with the lowest ranking. Hence the ranking seems to “skip” some of the ranking values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/extract_sample.html">extract_sample</a></span><span class="op">(</span>
  grtsdb <span class="op">=</span> <span class="va">db_mem</span>, samplesize <span class="op">=</span> <span class="fl">5</span>, bbox <span class="op">=</span> <span class="va">bbox</span>, cellsize <span class="op">=</span> <span class="va">cellsize</span>
<span class="op">)</span>
<span class="co">#&gt; Creating index for level 6. May take some time...</span>
<span class="co">#&gt;  Done.</span>
<span class="co">#&gt;     x1c    x2c ranking</span>
<span class="co">#&gt; 1 24500   8000       1</span>
<span class="co">#&gt; 2 29500 -24000       4</span>
<span class="co">#&gt; 3 20500 -17000       8</span>
<span class="co">#&gt; 4 47500   7000      11</span>
<span class="co">#&gt; 5 45500 -20000      14</span></code></pre></div>
<p>The last step is discard the grid cells outside of the sampling frame. Therefore the user needs to extract more grid cells within the bounding box than needed. The required oversampling rate is slightly larger than the ratio between the area of the bounding box and the area of the sampling frame. If the area of the bounding box is twice the area of the sampling frame, then extract at least twice the final sample size. Keep grid cells with smallest ranking in case you end up with too many grid cells in the sampling frame.</p>
<p>Because the randomisation is stored in the database, rerunning <code><a href="../reference/extract_sample.html">extract_sample()</a></code> on the same database with the same argument will yield the same sample. The example below is a rerun with a larger <code>samplesize</code>. Note that the first rows are identical. The sample is supplemented with additional grid cells. Internally the bounding box is centred with the full grid with <span class="math inline">\(2^n\)</span> cells in each dimension. As a result, shifting the bounding box will yield the same shift in the sample.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/extract_sample.html">extract_sample</a></span><span class="op">(</span>
  grtsdb <span class="op">=</span> <span class="va">db_mem</span>, samplesize <span class="op">=</span> <span class="fl">10</span>, bbox <span class="op">=</span> <span class="va">bbox</span>, cellsize <span class="op">=</span> <span class="va">cellsize</span>
<span class="op">)</span>
<span class="co">#&gt;      x1c    x2c ranking</span>
<span class="co">#&gt; 1  24500   8000       1</span>
<span class="co">#&gt; 2  29500 -24000       4</span>
<span class="co">#&gt; 3  20500 -17000       8</span>
<span class="co">#&gt; 4  47500   7000      11</span>
<span class="co">#&gt; 5  45500 -20000      14</span>
<span class="co">#&gt; 6  45500   3000      15</span>
<span class="co">#&gt; 7  10500 -17000      16</span>
<span class="co">#&gt; 8  27500  -2000      17</span>
<span class="co">#&gt; 9  28500 -23000      24</span>
<span class="co">#&gt; 10 45500 -14000      30</span></code></pre></div>
<p>The actual process of selecting the grid cells with a sampling frame is not implemented in <code>grtsdb</code>. This is a deliberate choice as it keeps the number of dependencies of the package minimal. In case of the 2D sampling frame, we recommend the <a href="https://r-spatial.github.io/sf/" class="external-link"><code>sf</code></a> package.</p>
</div>
<div class="section level2">
<h2 id="nested-samples">Nested samples<a class="anchor" aria-label="anchor" href="#nested-samples"></a>
</h2>
<p>Note that the output of <code><a href="../reference/add_level.html">add_level()</a></code> mentions adding several layers. This is because <code>grtsdb</code> stores the randomisation at every level. Level 1 being only 4 quadrants (<span class="math inline">\(4 ^ 1\)</span>), level 2 has 16 (<span class="math inline">\(4 ^ 2\)</span>) quadrants, … This implies that is straightforward to generate nested samples with different resolutions as long as the ratio between the resolutions is a power of two. The match is not perfect unless the bounding box is square and each dimension contains a power of 2 cells.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_sample.html">extract_sample</a></span><span class="op">(</span>
  grtsdb <span class="op">=</span> <span class="va">db_mem</span>, samplesize <span class="op">=</span> <span class="fl">20</span>, bbox <span class="op">=</span> <span class="va">bbox</span>, cellsize <span class="op">=</span> <span class="va">cellsize</span>
<span class="op">)</span>
<span class="va">coarse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_sample.html">extract_sample</a></span><span class="op">(</span>
  grtsdb <span class="op">=</span> <span class="va">db_mem</span>, samplesize <span class="op">=</span> <span class="fl">20</span>, bbox <span class="op">=</span> <span class="va">bbox</span>, cellsize <span class="op">=</span> <span class="va">cellsize</span> <span class="op">*</span> <span class="fl">4</span>
<span class="op">)</span>
<span class="co">#&gt; Creating index for level 4. May take some time...</span>
<span class="co">#&gt;  Done.</span></code></pre></div>
<div class="figure">
<img src="basic_files/figure-html/nesting-plot-1.png" alt="Example of two samples with nested grids." width="700"><p class="caption">
Example of two samples with nested grids.
</p>
</div>
</div>
<div class="section level2">
<h2 id="repeated-samples">Repeated samples<a class="anchor" aria-label="anchor" href="#repeated-samples"></a>
</h2>
<p>Image a long term monitoring of a number of sites within a given sampling frame. We can use a GRTS sample to get a spatially balanced selection. But what if the sampling frame changes in the future? E.g. the sampling frame is the set of all forests in a country. Deforested sites will leave the sampling frame while afforested sites will enter the sampling frame. Over time some of the early sampled sites might no longer be part of the sampling frame. We want to remove those sites from the sample and replace them with “fresh” sites. But what to do with the afforested sites that entered the sampling frame?</p>
<p>One solution would be to draw every so often a new an independent GRTS sample using the updated sampling frame. This would eliminate sites not longer in the sampling frame and allow new sites in the sampling frame to enter the sample. However, this brakes building a time series at sites that remain in the sampling frame.</p>
<p>We suggest to store the <code>grtsdb</code> database so the user can extract the same sample again in the future. This extraction is stable as long as we use the same database, with the same bounding box and cell size. The thing that changes is the sampling frame. Hence grid cells with low ranking outside the new sampling frame will be discarded. And new sites in the sampling frame enter the selection when they have a low ranking. The proportion of stable sites (sites both in the old and the new sample) will be proportional to the stable area (area in both the old and new sampling frame).</p>
</div>
<div class="section level2">
<h2 id="n-dimensional-grts">n-dimensional GRTS<a class="anchor" aria-label="anchor" href="#n-dimensional-grts"></a>
</h2>
<p>The original GRTS algorithm handles only 2D problems. We altered the algorithm so it can handle n-D problems.</p>
<p>Here is an example of a 1D problem.</p>
<pre><code><span class="co">#&gt; Required number of levels: 6</span>
<span class="co">#&gt; Adding level 1: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 2: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 3: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 4: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 5: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 6: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Creating index for level 6. May take some time...</span>
<span class="co">#&gt;  Done.</span>
<span class="co">#&gt;    x1c ranking</span>
<span class="co">#&gt; 1 0.47       0</span>
<span class="co">#&gt; 2 0.75       1</span>
<span class="co">#&gt; 3 0.89       3</span>
<span class="co">#&gt; 4 0.19       4</span>
<span class="co">#&gt; 5 0.65       5</span></code></pre>
<p>The next examples works on a 3D problem. Here we used cells with unequal size for different dimensions. Keep in mind that the “spatial” balance only holds for the rescaled version, assuming equal cell sizes in every dimension.</p>
<pre><code><span class="co">#&gt; Required number of levels: 4</span>
<span class="co">#&gt; Adding level 1: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 2: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 3: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Adding level 4: create table, add coordinates, calculate ranking</span>
<span class="co">#&gt; Creating index for level 4. May take some time...</span>
<span class="co">#&gt;  Done.</span>
<span class="co">#&gt;    x1c  x2c x3c ranking</span>
<span class="co">#&gt; 1 0.25 0.75 0.0      18</span>
<span class="co">#&gt; 2 0.85 0.75 0.2      19</span>
<span class="co">#&gt; 3 0.55 0.25 0.0      20</span>
<span class="co">#&gt; 4 0.55 0.35 0.6      22</span>
<span class="co">#&gt; 5 0.35 0.35 1.0      39</span></code></pre>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Stevens_Olsen_1999" class="csl-entry">
Stevens, Don L., and Anthony R. Olsen. 1999. <span>“<span>S</span>patially Balanced Sampling of Natural Resources.”</span> <em>Journal of the American Statistical Association</em> 99: 262–78.
</div>
<div id="ref-Stevens_Olsen_2003" class="csl-entry">
———. 2003. <span>“<span>V</span>ariance Estimation for Spatially Balanced Samples of Environmental Resources.”</span> <em>Environmetrics</em> 14 (6): 593–610.
</div>
<div id="ref-Stevens_Olsen_2004" class="csl-entry">
———. 2004. <span>“<span>S</span>patially Balanced Sampling of Natural Resources.”</span> <em>Journal Of The American Statistical Association</em> 99 (465): 262–78. <a href="https://doi.org/10.1198/016214504000000250" class="external-link">https://doi.org/10.1198/016214504000000250</a>.
</div>
<div id="ref-Theobald_etal_2007" class="csl-entry">
Theobald, David, Don Stevens, Denis White, N. Urquhart, Anthony Olsen, and John Norman. 2007. <span>“<span>U</span>sing <span>GIS</span> to <span>G</span>enerate <span>S</span>patially <span>B</span>alanced <span>R</span>andom <span>S</span>urvey <span>D</span>esigns for <span>N</span>atural <span>R</span>esource <span>A</span>pplications.”</span> <em>Environmental Management</em> 40 (1): 134–46. <a href="https://doi.org/10.1007/s00267-005-0199-x" class="external-link">https://doi.org/10.1007/s00267-005-0199-x</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.muscardinus.be" class="external-link">Thierry Onkelinx</a>, Bruno De Vos, <a href="https://www.vlaanderen.be/inbo/en-gb" class="external-link"><img src="https://inbo.github.io/checklist/reference/figures/logo-en.png" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
